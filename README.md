# Игра «Найди свой ОКВЭД по номеру телефона»

Реализовано решение на Python. Библиотеки: только стандартная библиотека, тесты работают через встроенный `unittest`. При реализации решения и тестов использовалась LLM ChatGPT.

## Архитектура
- `src/domain`: бизнес-логика нормализации и модель ОКВЭД.
- `src/infrastructure`: загрузка `okved.json` по HTTPS (`urllib.request`), URL по умолчанию — `https://raw.githubusercontent.com/bergstar/testcase/master/okved.json`.
- `src/usecases`: сценарий `FindOkvedUseCase`, объединяющий нормализацию, загрузку и поиск совпадения.
- `src/presentation`: CLI (`python -m src.presentation.cli "+7 999 1112233"`).

## Алгоритм
- **Нормализация номера**: выделяем все цифры. Поддерживаются форматы: `+7XXXXXXXXXX`, `8XXXXXXXXXX`, `9XXXXXXXXX`. Приводим к `+79XXXXXXXXX`. Не мобильные номера (первая цифра после кода страны не `9`) и неверная длина возвращают ошибку.
- **Парсинг ОКВЭД**: дерево `okved.json` разворачивается в плоский список, из кода извлекаются только цифры для сравнения.
- **Поиск совпадения**: выбирается запись с максимальной длиной совпадения по окончанию нормализованного номера (по цифровой части кода).  
  - Если совпадений нет, применяется детерминированная резервная стратегия: сумма цифр номера выбирает запись по модулю длины списка (гарантированно воспроизводимо).

## Запуск
```bash
python -m src.presentation.cli "+7 999 1112233"
# переопределить источник OKVED при необходимости:
python -m src.presentation.cli "+7 999 1112233" --okved-url https://example.com/okved.json
```

## Тесты
Тесты написаны на `unittest` и покрывают 100% строк решения:

```bash
python -m unittest discover -s tests
```

## Что выводит CLI
Пример вывода в формате JSON:
```json
{
  "normalized_phone": "+79991112233",
  "okved_code": "01.11.1",
  "okved_name": "Выращивание зерновых культур",
  "match_length": 5,
  "fallback_used": false
}
```

## Файлы
- Код: `src/`
- Тесты: `tests/`
